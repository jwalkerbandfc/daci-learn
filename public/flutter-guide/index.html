<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flutter Guide with DartPad</title>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600;700&family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="styles.css" rel="stylesheet" />
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="header-left">
                <h1>Flutter Masterclass</h1>
                <p>Cross-platform app development with live DartPad</p>
            </div>
            <div class="github-repo" onclick="toggleFileExplorer()">
                <svg viewBox="0 0 24 24">
                    <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v 3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                </svg>
                <span class="github-repo-text">View on GitHub</span>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Sidebar -->
            <div class="sidebar scrollbar-hide">
                <div class="sidebar-title">üìö Lessons</div>
                
                <div class="progress-section">
                    <div style="font-size: 0.85rem; font-weight: 600; color: var(--text-primary); margin-bottom: 0.5rem;">Progress</div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progress-fill" style="width: 0%"></div>
                    </div>
                    <div class="progress-text" id="progress-text">0/8 lessons completed</div>
                </div>

                <div class="lesson-list">
                    <div class="lesson-item active" data-lesson="0">Getting Started</div>
                    <div class="lesson-item" data-lesson="1">Widgets & UI</div>
                    <div class="lesson-item" data-lesson="2">Assets Management</div>
                    <div class="lesson-item" data-lesson="3">Navigation System</div>
                    <div class="lesson-item" data-lesson="4">Theme & Styling</div>
                    <div class="lesson-item" data-lesson="5">Data Persistence</div>
                    <div class="lesson-item" data-lesson="6">pubspec.yaml Config</div>
                    <div class="lesson-item" data-lesson="7">Debugging & Logging</div>
                </div>
            </div>

            <!-- Editor Section -->
            <div class="editor-section">
                <div class="editor-header">
                    <div>Lesson Content & DartPad</div>
                    <div class="editor-tabs">
                        <button class="editor-tab active" onclick="switchEditorTab('content')">Content</button>
                        <button class="editor-tab" onclick="switchEditorTab('github')">GitHub Files</button>
                    </div>
                </div>

                <div class="editor-content">
                    <!-- Lesson Content Tab -->
                    <div id="content-tab" style="flex: 1; display: flex; flex-direction: column; overflow: hidden;">
                        <div style="flex: 1; overflow-y: auto;" class="scrollbar-hide">
                            <!-- Lesson 0: Getting Started -->
                            <div class="lesson-content active" data-lesson="0">
                                <h2>üöÄ Getting Started with Flutter</h2>
                                <p>Flutter is Google's open-source UI framework for building beautiful, natively compiled applications for mobile, web, and desktop from a single codebase.</p>

                                <h3>Installation & Setup</h3>
                                <p>Download the Flutter SDK from <a href="https://flutter.dev" target="_blank" rel="noopener noreferrer" style="color: var(--primary); text-decoration: none; font-weight: 600;">flutter.dev</a> and follow the official installation guide for your operating system.</p>

                                <div class="code-block-snippet"><span class="code-comment"># Verify Flutter installation</span>
flutter --version

<span class="code-comment"># Create a new project</span>
flutter create my_app
cd my_app

<span class="code-comment"># Run the app</span>
flutter run</div>

                                <h3>Your First App: main.dart</h3>
                                <p>Every Flutter app starts with the <code style="background: #f1f5f9; padding: 0.25rem 0.5rem; border-radius: 4px; font-family: 'JetBrains Mono';">main()</code> function. Try this example in DartPad on the right:</p>

                                <div class="code-block-snippet"><span class="code-keyword">import</span> <span class="code-string">'package:flutter/material.dart'</span>;

<span class="code-keyword">void</span> main() {
  runApp(<span class="code-keyword">const</span> <span class="code-class">MyApp</span>());
}

<span class="code-keyword">class</span> <span class="code-class">MyApp</span> <span class="code-keyword">extends</span> <span class="code-class">StatelessWidget</span> {
  <span class="code-keyword">const</span> <span class="code-class">MyApp</span>();

  @override
  <span class="code-class">Widget</span> build(<span class="code-class">BuildContext</span> context) {
    <span class="code-keyword">return</span> <span class="code-class">MaterialApp</span>(
      title: <span class="code-string">'Flutter App'</span>,
      theme: <span class="code-class">ThemeData</span>(
        primarySwatch: <span class="code-class">Colors</span>.blue,
      ),
      home: <span class="code-keyword">const</span> <span class="code-class">HomePage</span>(),
    );
  }
}

<span class="code-keyword">class</span> <span class="code-class">HomePage</span> <span class="code-keyword">extends</span> <span class="code-class">StatelessWidget</span> {
  <span class="code-keyword">const</span> <span class="code-class">HomePage</span>();

  @override
  <span class="code-class">Widget</span> build(<span class="code-class">BuildContext</span> context) {
    <span class="code-keyword">return</span> <span class="code-class">Scaffold</span>(
      appBar: <span class="code-class">AppBar</span>(
        title: <span class="code-keyword">const</span> <span class="code-class">Text</span>(<span class="code-string">'Hello Flutter'</span>),
      ),
      body: <span class="code-keyword">const</span> <span class="code-class">Center</span>(
        child: <span class="code-class">Text</span>(<span class="code-string">'Hello, World!'</span>),
      ),
    );
  }
}</div>

                                <div class="tip-box">
                                    <strong>üí° Pro Tip:</strong> Use <code style="background: rgba(0,0,0,0.1); padding: 0.2rem 0.4rem; border-radius: 3px; font-family: 'JetBrains Mono';">flutter hot reload</code> to see changes instantly without restarting the app!
                                </div>

                                <div class="code-challenge">
                                    <div class="challenge-title">‚úèÔ∏è Challenge: Build Your First Widget</div>
                                    <div class="challenge-description">
                                        Create a StatelessWidget called <strong>GreetingCard</strong> that displays:
                                        <ul style="text-align: left; margin-top: 0.5rem;">
                                            <li>A title "Welcome to Flutter"</li>
                                            <li>A description text</li>
                                            <li>An ElevatedButton with "Get Started"</li>
                                        </ul>
                                    </div>
                                    <div style="display: flex; gap: 0.5rem; margin-top: 1.5rem; flex-wrap: wrap;">
                                        <button class="editor-button success" onclick="loadChallenge(0)">‚ñ∂ Load Challenge</button>
                                        <button class="hint-button" onclick="showHint(0)">üí° Show Hint</button>
                                    </div>
                                    <div class="challenge-feedback" id="feedback-0"></div>
                                </div>
                            </div>

                            <!-- Lesson 1: Widgets -->
                            <div class="lesson-content" data-lesson="1">
                                <h2>üß© Understanding Widgets</h2>
                                <p>Everything in Flutter is a widget. Widgets are the building blocks of Flutter apps, immutable objects that describe part of the user interface.</p>

                                <h3>Stateless Widgets</h3>
                                <p>Use <code style="background: #f1f5f9; padding: 0.25rem 0.5rem; border-radius: 4px; font-family: 'JetBrains Mono';">StatelessWidget</code> for widgets that don't change based on user interaction:</p>

                                <div class="code-block-snippet"><span class="code-keyword">class</span> <span class="code-class">UserCard</span> <span class="code-keyword">extends</span> <span class="code-class">StatelessWidget</span> {
  <span class="code-keyword">final</span> <span class="code-class">String</span> name;
  <span class="code-keyword">final</span> <span class="code-class">String</span> email;

  <span class="code-keyword">const</span> <span class="code-class">UserCard</span>({
    <span class="code-keyword">required</span> <span class="code-keyword">this</span>.name,
    <span class="code-keyword">required</span> <span class="code-keyword">this</span>.email,
  });

  @override
  <span class="code-class">Widget</span> build(<span class="code-class">BuildContext</span> context) {
    <span class="code-keyword">return</span> <span class="code-class">Card</span>(
      child: <span class="code-class">Column</span>(
        children: [
          <span class="code-class">Text</span>(name, style: <span class="code-class">TextStyle</span>(fontSize: 18)),
          <span class="code-class">Text</span>(email),
        ],
      ),
    );
  }
}</div>

                                <h3>Stateful Widgets</h3>
                                <p>Use <code style="background: #f1f5f9; padding: 0.25rem 0.5rem; border-radius: 4px; font-family: 'JetBrains Mono';">StatefulWidget</code> when your widget needs to manage mutable state:</p>

                                <div class="code-block-snippet"><span class="code-keyword">class</span> <span class="code-class">Counter</span> <span class="code-keyword">extends</span> <span class="code-class">StatefulWidget</span> {
  <span class="code-keyword">const</span> <span class="code-class">Counter</span>();

  @override
  <span class="code-class">State</span>&lt;<span class="code-class">Counter</span>&gt; createState() => <span class="code-class">_CounterState</span>();
}

<span class="code-keyword">class</span> <span class="code-class">_CounterState</span> <span class="code-keyword">extends</span> <span class="code-class">State</span>&lt;<span class="code-class">Counter</span>&gt; {
  <span class="code-keyword">int</span> count = 0;

  <span class="code-keyword">void</span> increment() {
    setState(() {
      count++;
    });
  }

  @override
  <span class="code-class">Widget</span> build(<span class="code-class">BuildContext</span> context) {
    <span class="code-keyword">return</span> <span class="code-class">Column</span>(
      children: [
        <span class="code-class">Text</span>(<span class="code-string">'Count: \$count'</span>),
        <span class="code-class">ElevatedButton</span>(
          onPressed: increment,
          child: <span class="code-keyword">const</span> <span class="code-class">Text</span>(<span class="code-string">'Increment'</span>),
        ),
      ],
    );
  }
}</div>

                                <h3>Common Layout Widgets</h3>
                                <ul>
                                    <li><strong>Scaffold</strong> - Material Design structure with app bar, body, and floating action button</li>
                                    <li><strong>Column</strong> - Arranges children vertically</li>
                                    <li><strong>Row</strong> - Arranges children horizontally</li>
                                    <li><strong>Stack</strong> - Overlays widgets on top of each other</li>
                                    <li><strong>ListView</strong> - Scrollable list of widgets</li>
                                    <li><strong>Container</strong> - Box with padding, margin, and decoration</li>
                                </ul>

                                <div class="warning-box">
                                    <strong>‚ö†Ô∏è Important:</strong> Always use <code style="background: rgba(0,0,0,0.1); padding: 0.2rem 0.4rem; border-radius: 3px; font-family: 'JetBrains Mono';">const</code> keywords with constructors to optimize performance.
                                </div>

                                <div class="code-challenge">
                                    <div class="challenge-title">‚úèÔ∏è Challenge: Stateful Counter</div>
                                    <div class="challenge-description">
                                        Create a <strong>StatefulWidget</strong> that:
                                        <ul style="text-align: left; margin-top: 0.5rem;">
                                            <li>Displays a counter value starting at 0</li>
                                            <li>Has buttons to increment and decrement</li>
                                            <li>Updates the display using setState()</li>
                                        </ul>
                                    </div>
                                    <div style="display: flex; gap: 0.5rem; margin-top: 1.5rem; flex-wrap: wrap;">
                                        <button class="editor-button success" onclick="loadChallenge(1)">‚ñ∂ Load Challenge</button>
                                        <button class="hint-button" onclick="showHint(1)">üí° Show Hint</button>
                                    </div>
                                    <div class="challenge-feedback" id="feedback-1"></div>
                                </div>
                            </div>

                            <!-- Additional lessons placeholder -->
                            <div class="lesson-content" data-lesson="2">
                                <h2>üì¶ Assets Management</h2>
                                <p>Assets are resources bundled with your app like images, fonts, JSON data, and other files.</p>
                                <p>Configure them in your pubspec.yaml file and access them in your code with Image.asset().</p>
                            </div>

                            <div class="lesson-content" data-lesson="3">
                                <h2>üß≠ Navigation System</h2>
                                <p>Flutter provides a powerful navigation system using the Navigator widget for managing a stack of routes.</p>
                            </div>

                            <div class="lesson-content" data-lesson="4">
                                <h2>üé® Theme & Styling</h2>
                                <p>Customize your app's appearance with themes and styling using ThemeData.</p>
                            </div>

                            <div class="lesson-content" data-lesson="5">
                                <h2>üíæ Data Persistence</h2>
                                <p>Save and retrieve data locally using SharedPreferences or databases.</p>
                            </div>

                            <div class="lesson-content" data-lesson="6">
                                <h2>üì¶ pubspec.yaml Configuration</h2>
                                <p>The pubspec.yaml file is your project's manifest, defining dependencies, assets, and metadata.</p>
                            </div>

                            <div class="lesson-content" data-lesson="7">
                                <h2>üêõ Debugging & Logging</h2>
                                <p>Master debugging techniques to identify and fix issues in your Flutter apps.</p>
                            </div>
                        </div>
                    </div>

                    <!-- GitHub File Browser Tab -->
                    <div id="github-tab" style="display: none; flex: 1; overflow: hidden;">
                        <div class="github-file-browser">
                            <div class="file-browser-header">üìÅ Project Structure</div>
                            <div class="file-tree">
                                <div class="file-tree-item folder">üìÅ my_app/</div>
                                <div class="file-tree-item file" style="margin-left: 1rem;">lib/main.dart</div>
                                <div class="file-tree-item file" style="margin-left: 1rem;">assets/images/</div>
                                <div class="file-tree-item file" style="margin-left: 1rem;">pubspec.yaml</div>
                                <div class="file-tree-item file" style="margin-left: 1rem;">android/</div>
                                <div class="file-tree-item file" style="margin-left: 1rem;">ios/</div>
                                <div class="file-tree-item file" style="margin-left: 1rem;">test/</div>
                            </div>
                        </div>
                    </div>

                    <!-- DartPad Integration -->
                    <div style="flex: 1; display: flex; gap: 1rem; overflow: hidden; min-height: 0; padding: 1.5rem;">
                        <div class="dartpad-container">
                            <div class="dartpad-header">
                                <span>üéØ DartPad Live Editor</span>
                                <div class="dartpad-status">
                                    <div class="status-indicator"></div>
                                    <span>Ready</span>
                                </div>
                            </div>
                            <div class="dartpad-iframe-container" id="dartpad-wrapper">
                                <!-- DartPad iframe will be embedded here -->
                            </div>
                            <div class="dartpad-controls">
                                <button onclick="loadDartPadChallenge()">üìù Load Challenge</button>
                                <button onclick="clearDartPad()">üóëÔ∏è Clear Code</button>
                                <button onclick="resetDartPad()">üîÑ Reset</button>
                                <button onclick="openInDartPad()">üîó Open in DartPad</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <script type="text/javascript" src="flutter_challenges.js"></script>
    <script>
        let currentLesson = 0;
        let completedLessons = new Set();
        let currentChallengeDartPadUrl = '';
        

        // Initialize
        document.querySelectorAll('.lesson-item').forEach((item, index) => {
            item.addEventListener('click', () => switchLesson(index));
        });

        function switchLesson(index) {
            document.querySelectorAll('.lesson-content').forEach(el => {
                el.classList.remove('active');
            });

            document.querySelectorAll('.lesson-item').forEach(el => {
                el.classList.remove('active');
            });

            document.querySelector(`.lesson-content[data-lesson="${index}"]`).classList.add('active');
            document.querySelector(`.lesson-item[data-lesson="${index}"]`).classList.add('active');

            currentLesson = index;
            updateProgress();
        }

        function switchEditorTab(tab) {
            document.querySelectorAll('.editor-tab').forEach(el => el.classList.remove('active'));
            event.target.classList.add('active');

            if (tab === 'content') {
                document.getElementById('content-tab').style.display = 'flex';
                document.getElementById('github-tab').style.display = 'none';
            } else {
                document.getElementById('content-tab').style.display = 'none';
                document.getElementById('github-tab').style.display = 'flex';
            }
        }

        function loadChallenge(id) {
            if (!challenges[id]) return;

            const code = challenges[id].code;
            embedDartPad(code);
            
            showFeedback(
                document.getElementById(`feedback-${id}`),
                'hint',
                `‚úÖ Challenge loaded! Edit the code on the right and click Run in DartPad to see your app.`
            );
        }

        function embedDartPad(code) {
            const wrapper = document.getElementById('dartpad-wrapper');
            
            // Clear existing iframe
            wrapper.innerHTML = '';

            // Create base64 encoded URL for DartPad
            const encodedCode = btoa(code);
            //const dartpadUrl = `https://dartpad.dev/embed-flutter.html?id=${generateId()}&code=${encodedCode}`;
            


            // Use the correct DartPad embed URL without gist ID
            const dartpadUrl = `https://dartpad.dev/?run=true`;

            currentChallengeDartPadUrl = dartpadUrl;

            const iframe = document.createElement('iframe');
            iframe.src = dartpadUrl;
            iframe.style.width = '100%';
            iframe.style.height = '100%';
            iframe.style.border = 'none';
            iframe.setAttribute('allow', 'camera; microphone; clipboard-read; clipboard-write');

            wrapper.appendChild(iframe);
            iframe.onload = () => {
                injectCodeToDartPad(iframe, code);
            };
        }

        function injectCodeToDartPad(iframe, code) {
            try {
                // Try multiple approaches to inject code
                const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
                
                if (!iframeDoc) {
                    console.warn('Cannot access iframe document. DartPad may need manual code paste.');
                    return;
                }

                // Look for CodeMirror instance (DartPad uses CodeMirror)
                if (iframe.contentWindow.window.editor) {
                    iframe.contentWindow.window.editor.setValue(code);
                    return;
                }

                // Try finding and updating contenteditable areas
                const editableElements = iframeDoc.querySelectorAll('[contenteditable="true"], .CodeMirror, textarea');
                if (editableElements.length > 0) {
                    const editor = editableElements[0];
                    if (editor.classList && editor.classList.contains('CodeMirror')) {
                        // CodeMirror instance
                        if (editor.CodeMirror) {
                            editor.CodeMirror.setValue(code);
                        }
                    } else {
                        // Direct text update
                        editor.textContent = code;
                        editor.innerText = code;
                        editor.value = code;
                        editor.dispatchEvent(new Event('input', { bubbles: true }));
                        editor.dispatchEvent(new Event('change', { bubbles: true }));
                    }
                }
            } catch (e) {
                // Cross-origin security may prevent direct access
                console.log('Could not directly inject code due to iframe restrictions. Code is ready in window.dartpadCode');
            }
        }

        function generateId() {
            return Math.random().toString(36).substring(2, 15);
        }

        function loadDartPadChallenge() {
            if (challenges[currentLesson]) {
                loadChallenge(currentLesson);
            } else {
                alert('No challenge available for this lesson.');
            }
        }

        function clearDartPad() {
            const wrapper = document.getElementById('dartpad-wrapper');
            wrapper.innerHTML = '<p style="padding: 2rem; text-align: center; color: #999;">DartPad cleared. Load a challenge to continue.</p>';
        }

        function resetDartPad() {
            loadDartPadChallenge();
        }

        function openInDartPad() {
            if (currentChallengeDartPadUrl) {
                // Extract code from URL and open DartPad directly
                window.open('https://dartpad.dev/', '_blank');
            }
        }

        function showHint(id) {
            const feedback = document.getElementById(`feedback-${id}`);
            if (challenges[id]) {
                showFeedback(feedback, 'hint', `üí° <strong>Hint:</strong> ${challenges[id].hint}`);
            }
        }

        function showFeedback(element, type, message) {
            element.className = `challenge-feedback ${type}`;
            element.innerHTML = message;
        }

        function updateProgress() {
            const total = 8;
            const completed = completedLessons.size;
            const percentage = (completed / total) * 100;
            
            document.getElementById('progress-fill').style.width = `${percentage}%`;
            document.getElementById('progress-text').textContent = `${completed}/${total} lessons completed`;
        }

        // Load initial DartPad with hello world
        function initializeDartPad() {
            const helloWorld = `import 'package:flutter/material.dart';

void main() {
  runApp(const MyApp());
}

class MyApp extends StatelessWidget {
  const MyApp();

  @override
  Widget build(BuildContext context) {
    return MaterialApp(
      home: Scaffold(
        appBar: AppBar(title: const Text('Hello Flutter')),
        body: const Center(
          child: Text('Hello, World!'),
        ),
      ),
    );
  }
}`;

            embedDartPad(helloWorld);
        }

        // Initialize on load
        window.addEventListener('load', () => {
            initializeDartPad();
            updateProgress();
        });
    </script>
</body>
</html>